<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800" style="font-family: 'Virgil', 'Segoe Print', 'Comic Sans MS', cursive; background: #ffffff;">
  <defs>
    <marker id="arrow4" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 Z" fill="#495057"/>
    </marker>
    <marker id="arrow4-red" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 Z" fill="#c92a2a"/>
    </marker>
    <filter id="shadow4">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" font-size="24" font-weight="bold" fill="#1e1e1e">Policy-as-Code — 4 Integration Modes</text>
  <text x="600" y="62" text-anchor="middle" font-size="14" fill="#868e96">Go Policy Agent with OPA/Rego across the entire software lifecycle</text>

  <!-- Central Policy Engine -->
  <rect x="400" y="280" width="400" height="130" rx="16" fill="#ffe3e3" stroke="#e03131" stroke-width="2.5" filter="url(#shadow4)"/>
  <text x="600" y="315" text-anchor="middle" font-size="20" font-weight="bold" fill="#c92a2a">Go Policy Agent</text>
  <text x="600" y="340" text-anchor="middle" font-size="13" fill="#e03131">OPA Engine + Claude AI</text>
  <line x1="440" y1="355" x2="760" y2="355" stroke="#ffc9c9" stroke-width="1"/>
  <text x="480" y="375" font-size="11" fill="#495057">validate(domain, config) → violations</text>
  <text x="480" y="393" font-size="11" fill="#495057">generate(domain, requirements) → YAML</text>
  <text x="480" y="405" font-size="11" fill="#495057">fix(domain, violations) → remediated YAML</text>

  <!-- Policy Domains (bottom center) -->
  <rect x="300" y="450" width="600" height="70" rx="10" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1.5"/>
  <text x="600" y="472" text-anchor="middle" font-size="13" font-weight="bold" fill="#495057">5 Policy Domains (policies/)</text>
  <rect x="315" y="485" width="95" height="25" rx="5" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
  <text x="362" y="502" text-anchor="middle" font-size="10" fill="#1864ab">Kubernetes</text>
  <rect x="420" y="485" width="75" height="25" rx="5" fill="#ffe8cc" stroke="#e8590c" stroke-width="1"/>
  <text x="457" y="502" text-anchor="middle" font-size="10" fill="#d9480f">Kafka</text>
  <rect x="505" y="485" width="90" height="25" rx="5" fill="#d3f9d8" stroke="#40c057" stroke-width="1"/>
  <text x="550" y="502" text-anchor="middle" font-size="10" fill="#2b8a3e">Terraform</text>
  <rect x="605" y="485" width="80" height="25" rx="5" fill="#d0bfff" stroke="#7950f2" stroke-width="1"/>
  <text x="645" y="502" text-anchor="middle" font-size="10" fill="#5f3dc4">CI/CD</text>
  <rect x="695" y="485" width="80" height="25" rx="5" fill="#eebefa" stroke="#9c36b5" stroke-width="1"/>
  <text x="735" y="502" text-anchor="middle" font-size="10" fill="#862e9c">GitOps</text>

  <!-- Mode 1: K8s Admission Webhook (top-left) -->
  <rect x="30" y="90" width="300" height="160" rx="12" fill="#d0ebff" stroke="#1971c2" stroke-width="2" filter="url(#shadow4)"/>
  <text x="180" y="118" text-anchor="middle" font-size="16" font-weight="bold" fill="#1864ab">Mode 1: K8s Webhook</text>
  <text x="180" y="138" text-anchor="middle" font-size="12" fill="#1971c2">ValidatingWebhookConfiguration</text>
  <line x1="50" y1="148" x2="310" y2="148" stroke="#a5d8ff" stroke-width="1"/>
  <text x="50" y="170" font-size="11" fill="#495057">kubectl apply deployment.yaml</text>
  <text x="50" y="188" font-size="11" fill="#495057">→ API Server intercepts</text>
  <text x="50" y="206" font-size="11" fill="#495057">→ Webhook validates against Rego</text>
  <text x="50" y="224" font-size="11" fill="#e03131">→ Admit or Deny with reasons</text>
  <text x="50" y="242" font-size="11" fill="#2b8a3e">→ AI suggests remediation</text>

  <!-- Arrow Mode 1 → Engine -->
  <path d="M 330 210 Q 380 260 400 310" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrow4-red)" stroke-dasharray="6,3"/>

  <!-- Mode 2: AI Chat Agent (top-right) -->
  <rect x="870" y="90" width="300" height="160" rx="12" fill="#d3f9d8" stroke="#40c057" stroke-width="2" filter="url(#shadow4)"/>
  <text x="1020" y="118" text-anchor="middle" font-size="16" font-weight="bold" fill="#2b8a3e">Mode 2: AI Chat Agent</text>
  <text x="1020" y="138" text-anchor="middle" font-size="12" fill="#37b24d">LangGraph Sub-Agent</text>
  <line x1="890" y1="148" x2="1150" y2="148" stroke="#b2f2bb" stroke-width="1"/>
  <text x="890" y="170" font-size="11" fill="#495057">"Validate my deployment YAML"</text>
  <text x="890" y="188" font-size="11" fill="#495057">→ Supervisor routes to Policy Agent</text>
  <text x="890" y="206" font-size="11" fill="#495057">→ Agent calls Go binary via HTTP</text>
  <text x="890" y="224" font-size="11" fill="#2b8a3e">→ Returns violations + AI fix</text>
  <text x="890" y="242" font-size="11" fill="#2b8a3e">→ "Generate compliant config"</text>

  <!-- Arrow Mode 2 → Engine -->
  <path d="M 870 210 Q 820 260 800 310" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrow4-red)" stroke-dasharray="6,3"/>

  <!-- Mode 3: CI/CD Gate (bottom-left) -->
  <rect x="30" y="560" width="300" height="160" rx="12" fill="#fff3bf" stroke="#f59f00" stroke-width="2" filter="url(#shadow4)"/>
  <text x="180" y="588" text-anchor="middle" font-size="16" font-weight="bold" fill="#e67700">Mode 3: CI/CD Gate</text>
  <text x="180" y="608" text-anchor="middle" font-size="12" fill="#f08c00">GitHub Actions Workflow</text>
  <line x1="50" y1="618" x2="310" y2="618" stroke="#ffe066" stroke-width="1"/>
  <text x="50" y="638" font-size="11" fill="#495057">PR touches k8s/ or terraform/</text>
  <text x="50" y="656" font-size="11" fill="#495057">→ policy-gate.yaml workflow fires</text>
  <text x="50" y="674" font-size="11" fill="#495057">→ policy-agent validate --domain k8s</text>
  <text x="50" y="692" font-size="11" fill="#e03131">→ Fails PR if violations found</text>
  <text x="50" y="710" font-size="11" fill="#2b8a3e">→ Posts fix suggestions as comment</text>

  <!-- Arrow Mode 3 → Engine -->
  <path d="M 330 600 Q 380 500 420 410" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrow4-red)" stroke-dasharray="6,3"/>

  <!-- Mode 4: Backstage Templates (bottom-right) -->
  <rect x="870" y="560" width="300" height="160" rx="12" fill="#d0bfff" stroke="#7950f2" stroke-width="2" filter="url(#shadow4)"/>
  <text x="1020" y="588" text-anchor="middle" font-size="16" font-weight="bold" fill="#5f3dc4">Mode 4: Backstage</text>
  <text x="1020" y="608" text-anchor="middle" font-size="12" fill="#7048e8">Scaffolder Template Action</text>
  <line x1="890" y1="618" x2="1150" y2="618" stroke="#d0bfff" stroke-width="1"/>
  <text x="890" y="638" font-size="11" fill="#495057">Developer creates new service</text>
  <text x="890" y="656" font-size="11" fill="#495057">→ Template generates configs</text>
  <text x="890" y="674" font-size="11" fill="#495057">→ Policy Agent validates before commit</text>
  <text x="890" y="692" font-size="11" fill="#2b8a3e">→ Compliant configs committed</text>
  <text x="890" y="710" font-size="11" fill="#e03131">→ Non-compliant: shows violations</text>

  <!-- Arrow Mode 4 → Engine -->
  <path d="M 870 600 Q 820 500 780 410" stroke="#c92a2a" stroke-width="2" marker-end="url(#arrow4-red)" stroke-dasharray="6,3"/>

  <!-- Claude AI callout -->
  <rect x="420" y="170" width="360" height="60" rx="10" fill="#fff9db" stroke="#f59f00" stroke-width="1.5" stroke-dasharray="5,3" filter="url(#shadow4)"/>
  <text x="600" y="195" text-anchor="middle" font-size="14" font-weight="bold" fill="#e67700">Claude AI Integration</text>
  <text x="600" y="215" text-anchor="middle" font-size="11" fill="#f08c00">Generate compliant configs + Fix violations + Explain policies</text>

  <!-- Arrow Claude → Engine -->
  <line x1="600" y1="230" x2="600" y2="278" stroke="#f08c00" stroke-width="1.5" marker-end="url(#arrow4)" stroke-dasharray="4,2"/>
</svg>