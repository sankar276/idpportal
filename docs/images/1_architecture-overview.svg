<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900" font-family="Segoe UI, Arial, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#495057"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1971c2"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2f9e44"/>
    </marker>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8f9fa" rx="8"/>

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" font-size="24" font-weight="bold" fill="#212529">IDP Portal - Architecture Overview</text>

  <!-- Developers -->
  <g filter="url(#shadow)">
    <rect x="50" y="70" width="200" height="60" rx="30" fill="#d0ebff" stroke="#1971c2" stroke-width="2"/>
    <text x="150" y="105" text-anchor="middle" font-size="15" font-weight="600" fill="#1971c2">Developers</text>
  </g>

  <!-- Platform Engineers -->
  <g filter="url(#shadow)">
    <rect x="950" y="70" width="200" height="60" rx="30" fill="#d3f9d8" stroke="#2f9e44" stroke-width="2"/>
    <text x="1050" y="105" text-anchor="middle" font-size="15" font-weight="600" fill="#2f9e44">Platform Engineers</text>
  </g>

  <!-- Portal UI Box -->
  <g filter="url(#shadow)">
    <rect x="50" y="170" width="500" height="100" rx="12" fill="#ffffff" stroke="#1971c2" stroke-width="2"/>
    <rect x="50" y="170" width="500" height="30" rx="12" fill="#1971c2"/>
    <rect x="50" y="188" width="500" height="12" fill="#1971c2"/>
    <text x="300" y="191" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">Portal UI (Next.js 15 + React 19)</text>
    <text x="110" y="230" font-size="12" fill="#495057">Dashboard</text>
    <text x="200" y="230" font-size="12" fill="#495057">AI Chat</text>
    <text x="280" y="230" font-size="12" fill="#495057">Catalog</text>
    <text x="365" y="230" font-size="12" fill="#495057">Self-Service</text>
    <text x="465" y="230" font-size="12" fill="#495057">Policies</text>
    <text x="110" y="255" font-size="12" fill="#495057">Deployments</text>
    <text x="210" y="255" font-size="12" fill="#495057">Kafka</text>
    <text x="285" y="255" font-size="12" fill="#495057">Secrets</text>
    <text x="370" y="255" font-size="12" fill="#495057">Clusters</text>
    <text x="465" y="255" font-size="12" fill="#495057">Knowledge</text>
  </g>

  <!-- Arrow: Developers -> UI -->
  <line x1="150" y1="130" x2="150" y2="168" stroke="#1971c2" stroke-width="2" marker-end="url(#arrow-blue)"/>

  <!-- Keycloak OIDC label -->
  <g filter="url(#shadow)">
    <rect x="580" y="190" width="130" height="40" rx="8" fill="#fff3bf" stroke="#e8590c" stroke-width="1.5"/>
    <text x="645" y="215" text-anchor="middle" font-size="12" font-weight="600" fill="#e8590c">Keycloak OIDC</text>
  </g>
  <line x1="550" y1="220" x2="578" y2="215" stroke="#e8590c" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- AI Backend Box -->
  <g filter="url(#shadow)">
    <rect x="50" y="320" width="700" height="320" rx="12" fill="#ffffff" stroke="#5f3dc4" stroke-width="2"/>
    <rect x="50" y="320" width="700" height="30" rx="12" fill="#5f3dc4"/>
    <rect x="50" y="338" width="700" height="12" fill="#5f3dc4"/>
    <text x="400" y="341" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">AI Backend (FastAPI + LangGraph)</text>
  </g>

  <!-- Arrow: UI -> Backend -->
  <line x1="300" y1="270" x2="300" y2="318" stroke="#495057" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="310" y="300" font-size="11" fill="#868e96">HTTPS + JWT</text>

  <!-- Supervisor Agent -->
  <g filter="url(#shadow)">
    <rect x="80" y="365" width="280" height="50" rx="8" fill="#e5dbff" stroke="#7048e8" stroke-width="1.5"/>
    <text x="220" y="395" text-anchor="middle" font-size="13" font-weight="600" fill="#5f3dc4">Supervisor Agent (LangGraph)</text>
  </g>

  <!-- Agent Grid -->
  <g>
    <!-- Row 1 -->
    <rect x="80" y="430" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="127" y="452" text-anchor="middle" font-size="11" fill="#1971c2">GitHub</text>

    <rect x="185" y="430" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="232" y="452" text-anchor="middle" font-size="11" fill="#1971c2">ArgoCD</text>

    <rect x="290" y="430" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="337" y="452" text-anchor="middle" font-size="11" fill="#1971c2">Flux</text>

    <rect x="395" y="430" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="442" y="452" text-anchor="middle" font-size="11" fill="#1971c2">Kafka</text>

    <rect x="500" y="430" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="547" y="452" text-anchor="middle" font-size="11" fill="#1971c2">Vault</text>

    <rect x="605" y="430" width="115" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="662" y="452" text-anchor="middle" font-size="11" fill="#1971c2">Backstage</text>

    <!-- Row 2 -->
    <rect x="80" y="475" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="127" y="497" text-anchor="middle" font-size="11" fill="#1971c2">Jira</text>

    <rect x="185" y="475" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="232" y="497" text-anchor="middle" font-size="11" fill="#1971c2">Slack</text>

    <rect x="290" y="475" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="337" y="497" text-anchor="middle" font-size="11" fill="#1971c2">PagerDuty</text>

    <rect x="395" y="475" width="95" height="35" rx="6" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="442" y="497" text-anchor="middle" font-size="11" fill="#1971c2">Rancher</text>

    <rect x="500" y="475" width="95" height="35" rx="6" fill="#ffd8a8" stroke="#e8590c" stroke-width="1.5"/>
    <text x="547" y="497" text-anchor="middle" font-size="11" font-weight="600" fill="#e8590c">Policy</text>
  </g>

  <!-- Protocols Row -->
  <g>
    <rect x="80" y="530" width="150" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="155" y="552" text-anchor="middle" font-size="11" fill="#2f9e44">MCP Server</text>

    <rect x="245" y="530" width="150" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="320" y="552" text-anchor="middle" font-size="11" fill="#2f9e44">A2A Protocol</text>

    <rect x="410" y="530" width="150" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="485" y="552" text-anchor="middle" font-size="11" fill="#2f9e44">Self-Service Engine</text>

    <rect x="575" y="530" width="150" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="650" y="552" text-anchor="middle" font-size="11" fill="#2f9e44">RAG / pgvector</text>
  </g>

  <!-- SSE label -->
  <rect x="80" y="582" width="640" height="25" rx="4" fill="#f1f3f5"/>
  <text x="400" y="599" text-anchor="middle" font-size="11" fill="#868e96">SSE Streaming | Keycloak JWT Auth | Async PostgreSQL + Redis</text>

  <!-- Policy Agent Box -->
  <g filter="url(#shadow)">
    <rect x="50" y="690" width="320" height="120" rx="12" fill="#ffffff" stroke="#e8590c" stroke-width="2"/>
    <rect x="50" y="690" width="320" height="28" rx="12" fill="#e8590c"/>
    <rect x="50" y="706" width="320" height="12" fill="#e8590c"/>
    <text x="210" y="709" text-anchor="middle" font-size="13" font-weight="bold" fill="#ffffff">Policy Agent (Go + OPA)</text>
    <text x="100" y="745" font-size="11" fill="#495057">CLI: validate | generate | fix</text>
    <text x="100" y="765" font-size="11" fill="#495057">HTTP API: /validate /generate /fix</text>
    <text x="100" y="785" font-size="11" fill="#495057">K8s Admission Webhook</text>
    <text x="100" y="805" font-size="11" fill="#e8590c" font-weight="600">5 Rego policy domains</text>
  </g>

  <!-- Arrow: Backend -> Policy Agent -->
  <line x1="210" y1="640" x2="210" y2="688" stroke="#e8590c" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="220" y="670" font-size="11" fill="#e8590c">HTTP</text>

  <!-- Platform Services Box -->
  <g filter="url(#shadow)">
    <rect x="420" y="690" width="330" height="120" rx="12" fill="#ffffff" stroke="#495057" stroke-width="2"/>
    <rect x="420" y="690" width="330" height="28" rx="12" fill="#495057"/>
    <rect x="420" y="706" width="330" height="12" fill="#495057"/>
    <text x="585" y="709" text-anchor="middle" font-size="13" font-weight="bold" fill="#ffffff">Platform Services (EKS)</text>

    <rect x="435" y="730" width="70" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="470" y="749" text-anchor="middle" font-size="10" fill="#5f3dc4">ArgoCD</text>

    <rect x="515" y="730" width="55" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="542" y="749" text-anchor="middle" font-size="10" fill="#5f3dc4">Flux</text>

    <rect x="580" y="730" width="75" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="617" y="749" text-anchor="middle" font-size="10" fill="#5f3dc4">Backstage</text>

    <rect x="665" y="730" width="70" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="700" y="749" text-anchor="middle" font-size="10" fill="#5f3dc4">Keycloak</text>

    <rect x="435" y="768" width="55" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="462" y="787" text-anchor="middle" font-size="10" fill="#5f3dc4">Vault</text>

    <rect x="500" y="768" width="55" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="527" y="787" text-anchor="middle" font-size="10" fill="#5f3dc4">Kafka</text>

    <rect x="565" y="768" width="70" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="600" y="787" text-anchor="middle" font-size="10" fill="#5f3dc4">Rancher</text>

    <rect x="645" y="768" width="90" height="28" rx="4" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="690" y="787" text-anchor="middle" font-size="10" fill="#5f3dc4">Gatekeeper</text>
  </g>

  <!-- Arrow: Backend -> Platform Services -->
  <line x1="585" y1="640" x2="585" y2="688" stroke="#495057" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Terraform / Infrastructure Box -->
  <g filter="url(#shadow)">
    <rect x="820" y="170" width="330" height="470" rx="12" fill="#ffffff" stroke="#2f9e44" stroke-width="2"/>
    <rect x="820" y="170" width="330" height="28" rx="12" fill="#2f9e44"/>
    <rect x="820" y="186" width="330" height="12" fill="#2f9e44"/>
    <text x="985" y="189" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">Infrastructure (Terraform)</text>
  </g>

  <!-- Arrow: Platform Eng -> Infra -->
  <line x1="1050" y1="130" x2="1050" y2="168" stroke="#2f9e44" stroke-width="2" marker-end="url(#arrow-green)"/>

  <!-- Terraform Modules -->
  <g>
    <rect x="845" y="215" width="130" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="910" y="237" text-anchor="middle" font-size="11" fill="#2f9e44">VPC (3 AZ)</text>

    <rect x="990" y="215" width="135" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="1057" y="237" text-anchor="middle" font-size="11" fill="#2f9e44">EKS 1.31</text>

    <rect x="845" y="260" width="130" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="910" y="282" text-anchor="middle" font-size="11" fill="#2f9e44">IAM Pod Identity</text>

    <rect x="990" y="260" width="135" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="1057" y="282" text-anchor="middle" font-size="11" fill="#2f9e44">KMS (Vault)</text>

    <rect x="845" y="305" width="130" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="910" y="327" text-anchor="middle" font-size="11" fill="#2f9e44">Secrets Manager</text>

    <rect x="990" y="305" width="135" height="35" rx="6" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="1057" y="327" text-anchor="middle" font-size="11" fill="#2f9e44">DynamoDB</text>
  </g>

  <!-- GitOps Bridge -->
  <g filter="url(#shadow)">
    <rect x="845" y="365" width="280" height="50" rx="8" fill="#fff3bf" stroke="#e8590c" stroke-width="2"/>
    <text x="985" y="385" text-anchor="middle" font-size="12" font-weight="bold" fill="#e8590c">GitOps Bridge</text>
    <text x="985" y="403" text-anchor="middle" font-size="10" fill="#868e96">TF outputs -> K8s Secret annotations</text>
  </g>

  <!-- Arrow down from GitOps Bridge -->
  <line x1="985" y1="415" x2="985" y2="440" stroke="#e8590c" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- ArgoCD ApplicationSet -->
  <g filter="url(#shadow)">
    <rect x="845" y="440" width="280" height="50" rx="8" fill="#e5dbff" stroke="#7048e8" stroke-width="2"/>
    <text x="985" y="460" text-anchor="middle" font-size="12" font-weight="bold" fill="#5f3dc4">ArgoCD ApplicationSet</text>
    <text x="985" y="478" text-anchor="middle" font-size="10" fill="#868e96">Cluster generator -> Helm values</text>
  </g>

  <!-- Arrow down from ApplicationSet -->
  <line x1="985" y1="490" x2="985" y2="515" stroke="#7048e8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- 14 Platform Addons -->
  <g filter="url(#shadow)">
    <rect x="845" y="515" width="280" height="100" rx="8" fill="#f8f9fa" stroke="#495057" stroke-width="1.5"/>
    <text x="985" y="537" text-anchor="middle" font-size="12" font-weight="bold" fill="#212529">14 Platform Addons</text>
    <text x="985" y="557" text-anchor="middle" font-size="10" fill="#868e96">ArgoCD, Flux, Backstage, Keycloak</text>
    <text x="985" y="572" text-anchor="middle" font-size="10" fill="#868e96">Vault, Kafka, Rancher, Cert-Manager</text>
    <text x="985" y="587" text-anchor="middle" font-size="10" fill="#868e96">External-DNS, External-Secrets, NGINX</text>
    <text x="985" y="602" text-anchor="middle" font-size="10" fill="#868e96">OPA Gatekeeper, Policy Agent, AI Platform</text>
  </g>

  <!-- External APIs Box -->
  <g filter="url(#shadow)">
    <rect x="820" y="690" width="330" height="120" rx="12" fill="#ffffff" stroke="#1971c2" stroke-width="2"/>
    <rect x="820" y="690" width="330" height="28" rx="12" fill="#1971c2"/>
    <rect x="820" y="706" width="330" height="12" fill="#1971c2"/>
    <text x="985" y="709" text-anchor="middle" font-size="13" font-weight="bold" fill="#ffffff">External APIs</text>

    <rect x="840" y="730" width="70" height="28" rx="4" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="875" y="749" text-anchor="middle" font-size="10" fill="#1971c2">GitHub</text>

    <rect x="920" y="730" width="55" height="28" rx="4" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="947" y="749" text-anchor="middle" font-size="10" fill="#1971c2">Jira</text>

    <rect x="985" y="730" width="55" height="28" rx="4" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="1012" y="749" text-anchor="middle" font-size="10" fill="#1971c2">Slack</text>

    <rect x="1050" y="730" width="80" height="28" rx="4" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="1090" y="749" text-anchor="middle" font-size="10" fill="#1971c2">PagerDuty</text>

    <rect x="840" y="768" width="85" height="28" rx="4" fill="#ffd8a8" stroke="#e8590c" stroke-width="1"/>
    <text x="882" y="787" text-anchor="middle" font-size="10" fill="#e8590c">Anthropic</text>

    <rect x="935" y="768" width="70" height="28" rx="4" fill="#ffd8a8" stroke="#e8590c" stroke-width="1"/>
    <text x="970" y="787" text-anchor="middle" font-size="10" fill="#e8590c">OpenAI</text>
  </g>

  <!-- Arrow: Backend -> External APIs -->
  <line x1="750" y1="500" x2="818" y2="750" stroke="#1971c2" stroke-width="1.5" stroke-dasharray="6,3" marker-end="url(#arrow-blue)"/>

  <!-- Legend -->
  <g>
    <rect x="50" y="845" width="1100" height="45" rx="8" fill="#f1f3f5" stroke="#dee2e6" stroke-width="1"/>
    <rect x="70" y="858" width="16" height="16" rx="3" fill="#d0ebff" stroke="#1971c2" stroke-width="1"/>
    <text x="92" y="872" font-size="11" fill="#495057">AI Agents</text>
    <rect x="175" y="858" width="16" height="16" rx="3" fill="#d3f9d8" stroke="#2f9e44" stroke-width="1"/>
    <text x="197" y="872" font-size="11" fill="#495057">Infrastructure</text>
    <rect x="300" y="858" width="16" height="16" rx="3" fill="#e5dbff" stroke="#7048e8" stroke-width="1"/>
    <text x="322" y="872" font-size="11" fill="#495057">GitOps / Platform</text>
    <rect x="440" y="858" width="16" height="16" rx="3" fill="#ffd8a8" stroke="#e8590c" stroke-width="1"/>
    <text x="462" y="872" font-size="11" fill="#495057">Policy / AI</text>
    <rect x="555" y="858" width="16" height="16" rx="3" fill="#fff3bf" stroke="#e8590c" stroke-width="1"/>
    <text x="577" y="872" font-size="11" fill="#495057">Auth / Bridge</text>
  </g>
</svg>
